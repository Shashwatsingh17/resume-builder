<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Digital Resume</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body id="app">
	<div class="container my-4" :style="{'--primary-color': config.primaryColor, '--secondary-color': config.secondaryColor, '--text-color': config.textColor}">
        <div class="row main-wrapper">
            <div class="col-4 left-col">
                <div>
                    <div class="img-wrapper mb-4">
                        <img src="profile-pic-square.jpg">
                    </div>
                    <h5 class="left-col__headline" contenteditable="true" @blur="onFinishEditHeadline($event, 'personal')">{{config.headlines.personal}}</h5>
                    <input class="pseudo-text-input w-100" type="text" value="config.contact.phone" v-model="config.contact.phone">
                    <input class="pseudo-text-input w-100" type="text" value="config.contact.email" v-model="config.contact.email">
                    <input class="pseudo-text-input w-100" type="text" value="config.contact.address" v-model="config.contact.address">
                </div>
                <div id="qualifications-section" class="mt-3">
                    <h5 class="left-col__headline" contenteditable="true" @blur="onFinishEditHeadline($event, 'qualifications')">{{config.headlines.qualifications}}</h5>
                    <ul>
                        <li v-for="(qualification, index) in config.qualifications">
                            <input class="pseudo-text-input w-100" type="text" :value="qualification" v-model="config.qualifications[index]">
                        </li>
                    </ul>
                    <div class="btn-wrapper mb-3" :class="[isEditable ? 'd-block' : 'd-none']">
                        <button v-if="config.qualifications[0]" class="btn btn-danger btn-remove mr-2" @click="removeQualification">-</button>
                        <button class="btn btn-secondary btn-add" @click="addQualification">+</button>
                    </div>
                </div>
            </div>
            <div class="col-8 right-col">
                <h3 class="right-col__main-headline pb-3 mb-0">
                    <input class="pseudo-text-input w-100" type="text" v-model="config.name" :value="config.name">
                </h3>
                <h5 class="right-col__subtitle py-3 mb-4">
                    <input class="pseudo-text-input w-100" type="text" v-model="config.title" :value="config.title">
                </h5>
                <div>
                    <h4 class="right-col__section-headline" contenteditable="true" @blur="onFinishEditHeadline($event, 'experience')">{{config.headlines.experience}}</h4>
                    <div class="card-text" v-for="(experience, index) in config.experiences">
                        <h6 class="right-col__sub-headline">
                            <input class="pseudo-text-input w-100" type="text" :value="experience.role" v-model="config.experiences[index].role">
                        </h6>
                        <div class="d-flex">
                            <input class="pseudo-text-input w-50" type="text" :value="experience.company" v-model="config.experiences[index].company">
                            <input class="pseudo-text-input ml-auto w-50 text-right" type="text" :value="experience.date" v-model="config.experiences[index].date">
                        </div>
                        <ul>
                            <li v-for="(item, i) in experience.descriptionItems">
                                <input class="pseudo-text-input w-100" type="text" :value="item" v-model="config.experiences[index].descriptionItems[i]">
                            </li>
                        </ul>
                        <div class="btn-wrapper-small mb-3" :class="[isEditable ? 'd-block' : 'd-none']">
                            <button v-if="experience.descriptionItems[0]" class="btn btn-danger btn-remove mr-2" @click="removeExperienceItem(index)">-</button>
                            <button class="btn btn-secondary btn-add" @click="addExperienceItem(index)">+</button>
                        </div>
                    </div>
                    <div class="btn-wrapper mb-3" :class="[isEditable ? 'd-block' : 'd-none']">
                        <button v-if="config.experiences[0]" class="btn btn-danger btn-remove mr-2" @click="removeExperience(index)">-</button>
                        <button class="btn btn-secondary btn-add" @click="addExperience(index)">+</button>
                    </div>

                    <h4 class="mt-4 right-col__section-headline" contenteditable="true" @blur="onFinishEditHeadline($event, 'education')">{{config.headlines.education}}</h4>
                    <div class="card-text" v-for="(item, index) in config.education">
                        <h6 class="right-col__sub-headline">
                            <input class="pseudo-text-input w-100" type="text" :value="item.title" v-model="config.education[index].title">
                        </h6>
                        <div class="d-flex">
                            <input class="pseudo-text-input w-50" type="text" :value="item.institution" v-model="config.education[index].institution">
                            <input class="pseudo-text-input w-50 text-right" type="text" :value="item.date" v-model="config.education[index].date">
                        </div>
                        <ul>
                            <li v-for="(desc, i) in item.descriptionItems">
                                <input class="pseudo-text-input w-100" type="text" :value="desc" v-model="config.education[index].descriptionItems[i]">
                            </li>
                        </ul>
                        <div class="btn-wrapper-small mb-3" :class="[isEditable ? 'd-block' : 'd-none']">
                            <button v-if="item.descriptionItems[0]" class="btn btn-danger btn-remove mr-2" @click="removeEducationDescItem(index)">-</button>
                            <button class="btn btn-secondary btn-add" @click="addEducationDescItem(index)">+</button>
                        </div>
                    </div>
                    <div class="btn-wrapper mb-3" :class="[isEditable ? 'd-block' : 'd-none']">
                        <button v-if="config.education[0]" class="btn btn-danger btn-remove mr-2" @click="removeEducationItem">-</button>
                        <button class="btn btn-secondary btn-add" @click="addEducationItem">+</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="sidebar" @mouseenter="sidebarOpen" ref="sidebar">
        <button class="btn btn-close-sidebar" @click="sidebarClose">x</button>
        <label class="d-flex align-items-center mr-4">
            <input type="color" class="mr-2 colorpicker" v-model="config.primaryColor" :value="config.primaryColor">
            Primary color
        </label>
        <label class="d-flex align-items-center mr-4">
            <input type="color" class="mr-2 colorpicker" v-model="config.secondaryColor">
            Secondary color
        </label>
        <label class="d-flex align-items-center mr-4">
            <input type="color" class="mr-2 colorpicker" v-model="config.textColor">
            Text color
        </label>
        
        <div class="mt-4 p-2 border-radius-2" style="background-color: white">
            <input type="file" id="selected-file">
        </div>

        <button class="btn btn-block btn-secondary mt-4" @click="useConfig">Use uploaded configuration</button>

        <button class="btn btn-block btn-success mr-2 mt-4" @click="saveConfig">Save configuration</button>
    </div>
    <script>
        Vue.createApp({
            data() {
                return {
                    config: {
                        primaryColor: "#8C7D69",
                        secondaryColor: "#F5F5F5",
                        textColor: "#323232",
                        qualifications: ["dance", "art"],
                        name: "Moni Mustermann",
                        title: "Master of Science Psychology",
                        headlines: {
                            personal: "About",
                            qualifications: "Qualifications",
                            experience: "Experience",
                            education: "Education"
                        },
                        experiences: [
                            {
                                date: "01/2021 – now",
                                role: "Full Stack Web Developer",
                                company: "Solution 360 GmbH, Berlin",
                                descriptionItems: [
                                    "Frontend and backend development of Ecommerce shops",
                                    "Shopware 6 with Twig, Bootstrap, Javascript & Vue.Js, PHP & Symfony",
                                    "Customized and extended shop functionalities with Shopware Plugins"
                                ]
                            }
                        ],
                        education: [
                            {
                                date: "02/2020 – 08/2020",
                                institution: "Universität de Barcelona, Spain",
                                title: "Psychology, Bachelor of Science",
                                descriptionItems: [
                                    "summa cum laude, GPA 1.3",
                                    "Speaker of class",
                                    "Relevant coursework includes: Mastering resume building"
                                ]
                            }
                        ],
                        contact: {
                            phone: "015773909584",
                            email: "contact@gmail.com",
                            address: "Hauptstraße 100, 19777 Berlin"
                        }
                    },
                    isEditable: false
                }
            },
            methods: {
                addQualification(){
                    this.config.qualifications.push("new entry")
                },
                removeQualification(){
                    this.config.qualifications.pop();
                },
                removeEducationDescItem(index){
                    this.config.education[index].descriptionItems.pop();
                },
                addEducationDescItem(index){
                    this.config.education[index].descriptionItems.push("neuer Eintrag");
                },
                removeExperienceItem(index){
                    this.config.experiences[index].descriptionItems.pop();
                },
                addExperienceItem(index){
                    this.config.experiences[index].descriptionItems.push("neuer Eintrag");
                },
                removeEducationItem(){
                    this.config.education.pop();
                },
                addEducationItem(){
                    this.config.education.push(
                        {
                            date: "Spain, 02/2021 – 08/2023",
                            institution: "Universität de Barcelona",
                            title: "Psychology, Master of Science",
                            descriptionItems: [
                                "summa cum laude, GPA 1.5",
                                "Relevant coursework includes: Mastering resume building"
                            ]
                        }
                    );
                },
                addExperience(){
                    this.config.experiences.push(
                        {
                            date: "from - til",
                            role: "Role",
                            company: "Company, location",
                            descriptionItems: [
                                "what I did there"
                            ]
                        }
                    );
                },
                removeExperience(){
                    this.config.experiences.pop();
                },
                saveConfig(){
                    const data = JSON.stringify(this.config)
                    const blob = new Blob([data], {type: 'text/plain'})
                    a = document.createElement('a');
                    a.download = "resume_configuration.json";
                    a.href = window.URL.createObjectURL(blob);
                    a.click();
                },
                useConfig(){
                    const files = document.getElementById("selected-file").files;
                    if (files.length <= 0) {
                        return false;
                    }

                    const fr = new FileReader();

                    fr.addEventListener('load', () => {
                        const result = JSON.parse(fr.result);
                        this.config = result;
                    })

                    fr.readAsText(files.item(0));
                },
                onFinishEditHeadline(e, key){
                    this.config.headlines[key] = e.target.innerText;
                },
                sidebarClose(e){
                    this.$refs.sidebar.classList.remove("sidebar-show");
                    this.$refs.sidebar.classList.add("sidebar-hide");
                    this.isEditable = false;
                },
                sidebarOpen(e){
                    event.target.classList.remove("sidebar-hide");
                    event.target.classList.add("sidebar-show");
                    this.isEditable = true;
                }
            }
        }).mount('#app')
    </script>
</body>
</html>